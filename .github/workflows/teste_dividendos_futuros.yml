name: Testar Dividendos Futuros

on:
  workflow_dispatch:

jobs:
  testar:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      
      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'
      
      - name: Instalar dependÃªncias
        run: pip install pandas requests
      
      - name: Testar dividendos futuros
        run: |
          python src/capturar_dividendos_futuros.py --modo lista --lista "PETR4,VALE3,ITUB4,BBAS3,TAEE11,BBSE3,EGIE3,CPLE6"
      
      - name: Mostrar arquivos gerados
        run: |
          echo "=== Arquivos gerados ==="
          find balancos -name "dividendos_futuros.json" -exec echo "---" \; -exec cat {} \;
          
          echo ""
          echo "=== Agenda consolidada ==="
          if [ -f "balancos/agenda_dividendos.json" ]; then
            cat balancos/agenda_dividendos.json
          else
            echo "Nenhuma agenda gerada (sem dividendos futuros)"
          fi
