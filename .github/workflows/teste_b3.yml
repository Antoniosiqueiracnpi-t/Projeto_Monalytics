name: Teste API B3

on:
  workflow_dispatch:

jobs:
  teste:
    runs-on: ubuntu-latest
    steps:
      - name: Testar API B3
        run: |
          python3 << 'EOF'
          import requests
          import base64
          import json

          ticker = "PETR"
          params = {"language": "pt-br", "pageNumber": 1, "pageSize": 20, "company": ticker}
          params_b64 = base64.b64encode(json.dumps(params).encode()).decode()
          url = f"https://sistemaswebb3-listados.b3.com.br/listedCompaniesProxy/CompanyCall/GetInitialCompanies/{params_b64}"

          try:
              response = requests.get(url, timeout=10, verify=False)
              print(f"Status: {response.status_code}")
              print(f"Resposta: {response.text[:500]}")
          except Exception as e:
              print(f"Erro: {type(e).__name__}: {e}")
          EOF
